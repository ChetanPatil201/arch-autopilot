[
  {
    "rule_id": "AZ001",
    "title": "Storage account does not enforce HTTPS-only traffic",
    "severity": "high",
    "category": "Security",
    "resource_type": "azurerm_storage_account",
    "resource_name": "sa",
    "file": "/Users/poonambhatjire/Desktop/Chetan/arch_autopilot/sample_tf/main.tf",
    "evidence": "enable_https_traffic_only is missing or not set to true.",
    "remediation": "Set enable_https_traffic_only = true on the azurerm_storage_account.",
    "confidence": 0.95
  },
  {
    "rule_id": "AZ002",
    "title": "Storage account allows public blob access",
    "severity": "high",
    "category": "Security",
    "resource_type": "azurerm_storage_account",
    "resource_name": "sa",
    "file": "/Users/poonambhatjire/Desktop/Chetan/arch_autopilot/sample_tf/main.tf",
    "evidence": "allow_blob_public_access is missing or not set to false.",
    "remediation": "Set allow_blob_public_access = false on the azurerm_storage_account.",
    "confidence": 0.9
  },
  {
    "rule_id": "AZ003",
    "title": "Key Vault purge protection is not enabled",
    "severity": "high",
    "category": "Security",
    "resource_type": "azurerm_key_vault",
    "resource_name": "kv",
    "file": "/Users/poonambhatjire/Desktop/Chetan/arch_autopilot/sample_tf/main.tf",
    "evidence": "purge_protection_enabled is missing or not set to true.",
    "remediation": "Set purge_protection_enabled = true on the azurerm_key_vault.",
    "confidence": 0.9
  },
  {
    "rule_id": "AZ004",
    "title": "Key Vault soft delete retention is missing or too low",
    "severity": "high",
    "category": "Security",
    "resource_type": "azurerm_key_vault",
    "resource_name": "kv",
    "file": "/Users/poonambhatjire/Desktop/Chetan/arch_autopilot/sample_tf/main.tf",
    "evidence": "soft_delete_retention_days is missing or < 7 days.",
    "remediation": "Set soft_delete_retention_days to at least 7 (or your policy) on azurerm_key_vault.",
    "confidence": 0.85
  },
  {
    "rule_id": "AZ005",
    "title": "NSG allows inbound SSH/RDP from the public internet",
    "severity": "high",
    "category": "Security",
    "resource_type": "azurerm_network_security_rule",
    "resource_name": "ssh_open",
    "file": "/Users/poonambhatjire/Desktop/Chetan/arch_autopilot/sample_tf/main.tf",
    "evidence": "Allow inbound with public source (0.0.0.0/0) and destination port (22).",
    "remediation": "Restrict inbound SSH/RDP to trusted IP ranges, use VPN/Bastion, or remove the rule.",
    "confidence": 0.8
  },
  {
    "rule_id": "AZ006",
    "title": "Azure SQL server allows public network access",
    "severity": "high",
    "category": "Security",
    "resource_type": "azurerm_mssql_server",
    "resource_name": "sql",
    "file": "/Users/poonambhatjire/Desktop/Chetan/arch_autopilot/sample_tf/main.tf",
    "evidence": "public_network_access_enabled is missing or not set to false.",
    "remediation": "Set public_network_access_enabled = false and use private endpoints/VNet integration.",
    "confidence": 0.85
  },
  {
    "rule_id": "AZ007",
    "title": "Storage account encryption at rest is not explicitly enabled",
    "severity": "high",
    "category": "Security",
    "resource_type": "azurerm_storage_account",
    "resource_name": "sa",
    "file": "/Users/poonambhatjire/Desktop/Chetan/arch_autopilot/sample_tf/main.tf",
    "evidence": "Encryption settings for storage account are missing or incomplete.",
    "remediation": "Ensure encryption.services.blob.enabled = true on azurerm_storage_account.",
    "confidence": 0.8
  },
  {
    "rule_id": "AZ008",
    "title": "Storage account does not enforce TLS 1.2+",
    "severity": "high",
    "category": "Security",
    "resource_type": "azurerm_storage_account",
    "resource_name": "sa",
    "file": "/Users/poonambhatjire/Desktop/Chetan/arch_autopilot/sample_tf/main.tf",
    "evidence": "min_tls_version is missing or not set to TLS1_2 (or higher).",
    "remediation": "Set min_tls_version = \"TLS1_2\" on the azurerm_storage_account.",
    "confidence": 0.85
  },
  {
    "rule_id": "AZ009",
    "title": "Storage account network rules do not default to Deny",
    "severity": "high",
    "category": "Security",
    "resource_type": "azurerm_storage_account",
    "resource_name": "sa",
    "file": "/Users/poonambhatjire/Desktop/Chetan/arch_autopilot/sample_tf/main.tf",
    "evidence": "network_rules.default_action is missing or not set to Deny.",
    "remediation": "Add network_rules { default_action = \"Deny\" } and explicitly allow trusted networks.",
    "confidence": 0.8
  },
  {
    "rule_id": "AZ010",
    "title": "Key Vault allows public network access",
    "severity": "high",
    "category": "Security",
    "resource_type": "azurerm_key_vault",
    "resource_name": "kv",
    "file": "/Users/poonambhatjire/Desktop/Chetan/arch_autopilot/sample_tf/main.tf",
    "evidence": "Public network access is not explicitly disabled.",
    "remediation": "Disable public access and use Private Endpoint/VNet integration for Key Vault.",
    "confidence": 0.8
  }
]